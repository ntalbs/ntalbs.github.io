<!DOCTYPE html><html><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-2098194-3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-2098194-3');</script><meta charset="utf-8"><meta name="google-site-verification" content="U8HPz3to00q8wRxuKaw82QsuVvOzGyPxcWhySSYAjOE"><meta name="viewport" content="width=device-width,initial-scale=1"><title>org-mode 스프레드시트로 사용하기 @ntalbs' stuff</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"></head><body><div id="progress"><div id="bar"></div><div class="container"><div id="scroll-title">org-mode 스프레드시트로 사용하기</div></div></div><nav class="navbar" role="navigation"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle unselectable" data-toggle="collapse" data-target="#nav-items">+</button>
<a class="navbar-brand unselectable" href="/">@ntalbs' stuff</a></div><div class="navbar-items collapsed" id="nav-items"><ul><li><a class="unselectable" href="/archive/">Archive</a></li><li><a class="unselectable" href="/tags/">Tags</a></li><li><a class="unselectable" href="/about/">About</a></li></ul></div></div></nav><header class="page-head"><div class="container"><p class="blog-description">내 이 세상 도처에서 쉴 곳을 찾아보았으나, 마침내 찾아낸, 컴퓨터가 있는 구석방보다 나은 곳은 없더라.</p></div></header><main class="container" role="main"><article class="post"><header><p class="post-meta"><time datetime="2019-03-25" itemprop="datePublished">2019-03-25</time>
on
<a href="/tags/emacs/">Emacs</a></p><h1 class="post-title">org-mode 스프레드시트로 사용하기</h1></header><section class="post-content"><p>Emacs에는 <a href="https://orgmode.org/">org-mode</a>란 도구가 있다. 할 일 목록, 일정, 작업 로그를 정리할 때 유용하다. 행열 추가/삭제, 행열 이동 등 기본 표 편집도 가능하며, 표 안에서 간단한 계산도 가능하다. 여기서는 표 계산 방법을 간단히 살펴보려 한다. 이 글은 <a href="https://orgmode.org/worg/org-tutorials/org-spreadsheet-intro.html">Org as a spreadsheet system: a short introduction</a>을 참고해 정리한 것이다.</p><h2 id="-">테이블 생성</h2><p>org-mode로 표 계산을 하려면 면서 표를 삽입해야 한다. 현재 버퍼가 org-mode라면 메뉴에 Org관련 항목이 표시된다. <code>Tbl &gt; Create</code>를 선택해 표를 넣을 수도 있지만, 일반 Emacs 사용자라면 <code>M-x org-table-create</code>를 실행하는 쪽을 선호할 것이다. org-mode에서 표는 그냥 텍스트로 되어 있고 열 구분자로 <code>|</code>를 사용하므로 별도 명령을 실행시킬 필요 없이 <code>|</code>로 행을 시작하면 바로 표를 만들 수 있다.</p><pre><code>| Name   | English | Math | Science |
|--------+---------+------+---------|
| Apple  |      88 |   75 |      90 |
| Orange |      77 |   65 |      55 |
| Banana |      90 |   95 |      88 |
</code></pre><h2 id="-1">셀 참조</h2><pre><code>| Name   | English | Math | Science | Total     |
|--------+---------+------+---------+-----------|
| Apple  |      88 |   75 |      90 | [Forumla] |
| Orange |      77 |   65 |      55 |           |
| Banana |      90 |   95 |      88 |           |
</code></pre><p>위 표에서 <code>[Formula]</code> 위치에 English, Math, Science 점수 합계를 계산해 넣어려 한다. 수식을 넣으려면 다른 셀의 데이터를 참조해야 하므로 셀 참조 방법을 알아야 한다. 커서를 <code>[Formula]</code> 셀에 놓고 <code>C-c ?</code>를 누르면 미니버퍼에 <code>line: 2, col: 5, ref: @2$5 or E2</code>가 표시된다. 따라서 이 셀은 <code>@2$5</code> 또는 <code>E2</code>로 참조할 수 있지만, 수식을 계산하면 참조가 <code>@2$5</code>와 같은 형식으로 바뀌므로, 그냥 org-mode 형식에 익숙해지는 게 좋겠다.</p><p>표 안에 커서가 있는 상태에서 <code>C-c }</code>를 누르면 다음과 같이 표에 행과 열 번호가 표시된다.</p><pre><code>  1| Name   | English | Math | Science | Total     |
I*1|$1------+$2-------+$3----+$4-------+$5---------|
  2| Apple  |      88 |   75 |      90 | [Forumla] |
  3| Orange |      77 |   65 |      55 |           |
  3| Banana |      90 |   95 |      88 |           |
</code></pre><h2 id="-2">수식 입력</h2><p>위 표에서 <code>[Formula]</code> 위치에 <code>:=vsum($2..$4)</code>를 입력한다. 수식은 현재 행에서 <code>$2</code>부터 <code>$4</code>까지 열의 숫자를 더하라는 뜻이다. 그리고 커서가 수식에 있는 상태에서 <code>C-c C-c</code>를 누르면 수식이 계산 결과로 바뀌고, 테이블 밑에 <code>#+TBLFM</code>으로 시작하는 행이 추가되는 것을 볼 수 있다.</p><h2 id="---">열 수식, 셀 수식</h2><p>위에서 Apple 학생의 과목 점수 합계를 구했는데, 다른 학생에 대해서도 같은 작업을 하고 싶다. 즉 열의 모든 셀에 같은 수식을 적용하고 싶다. 이때 열 수식을 사용할 수 있다. 열 수식을 입력하려면 수식을 입력할 때 <code>:=</code>로 시작하는 대신 <code>=</code>로 시작하면 된다.</p><p><code>C-c C-c</code>를 누르면 수식을 입력한 셀만 계산 값으로 바뀐다. 열 전체에 계산 결과를 넣으려면 <code>C-u C-c *</code>를 누르면 된다. 커서가 <code>#+TBLFM</code> 행 위에 있으면 <code>C-c C-c</code>를 눌러도 모든 수식을 다시 계산한다.</p><pre><code>| Name   | English | Math | Science | Total |
|--------+---------+------+---------+-------|
| Apple  |      88 |   75 |      90 |   253 |
| Orange |      77 |   65 |      55 |   197 |
| Banana |      90 |   95 |      88 |   273 |
#+TBLFM: $5=vsum($2..$4)
</code></pre><p>셀 수식이었을 때는 <code>#+TBLFM</code>에 수식이 <code>@2$5=vsum($2..$4)</code>로 표현되었는데, 열 수식으로 바꾸니 <code>$5=vsum($2..$4)</code>로 바뀌었다. 셀 수식이었을 때는 <code>@2$5</code> 셀에 계산 결과가 반영되었지만 열 수식에서는 <code>$5</code>열 전체에 계산 결과가 적용된다.</p><h2 id="--">대화형 수식 편집</h2><p>지금까지는 셀에 직접 <code>:=</code> 또는 <code>=</code>를 입력해 셀 수식 또는 열 수식을 입력했다. 취향에 따라<code>C-u C-c =</code> 또는 <code>C-c =</code>를 눌러 미니버퍼에서 셀 수식 또는 열 수식을 입력할 수도 있다. 그러나 <code>C-'</code>를 누르면 전용 버퍼에서 수식을 편집할 수 있다. 수식 편집 시 커서가 참조 위에 있으면 해당 참조 영역이 표에서 하이라이트 된다. <code>S-&lt;left/right/up/down&gt;</code>으로 참조 영역을 선택할 수도 있다.</p><p><img src="/2019/03-25-org-mode-as-a-spreadsheet/org-spreadsheet.png" alt=""></p><h2 id="heading">맺음말</h2><p>지금까지 org-mode에서 표 계산 사용 방법을 간단히 살펴 보았다. 이 정도면 웬만한 스트레드시트가 부럽지 않다. 표가 아주 크다든가 복잡한 계산이 필요한 경우, 차트를 그려야 하는 경우라면 구글 스프레드시트를 사용하겠지만, 간단한 표 계산이 필요한 경우라면 매우 유용하게 사용할 수 있다.</p><h2 id="heading1">참고</h2><ul><li><a href="https://orgmode.org/">org-mode</a> 줄여서 Org라고도 한다. org-mode 홈페이지에서도 Org와 org-mode를 섞어 사용한다.</li><li><a href="https://orgmode.org/worg/org-tutorials/org-spreadsheet-intro.html">Org as a spreadsheet system: a short introduction</a></li></ul></section><footer class="post-footer"><div class="social button-box"><a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a>
<a class="twitter-follow-button" href="https://twitter.com/ntalbs" data-show-count="false">Follow @ntalbs</a>
<script async="" src="//platform.twitter.com/widgets.js"></script></div><nav id="article-nav"><a class="article-nav-link-wrap previous" href="https://ntalbs.github.io/2019/check-str-rotation/" id="article-nav-newer">회전 문자열 검사 방법</a>
<a class="article-nav-link-wrap next" href="https://ntalbs.github.io/2019/emacs-number-series/" id="article-nav-older">Emacs: 숫자 범위 포함 텍스트 생성</a></nav></footer></article></main><section class="section"><div class="container"><aside><div id="disqus_thread"></div></aside><script type="text/javascript">var disqus_shortname='ntalbs-stuff';(function(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div></section><section class="section"><div class="container has-text-centered"><p></p></div></section><script src="https://ntalbs.github.io/js/index.js" type="text/javascript"></script><footer class="page-bottom"><div class="inner"><section class="copyright">© 2008-2019 <a href="/about">ntalbs</a></section><section class="poweredby">Powered by <a class="icon-ghost" href="https://gohugo.io">Hugo</a></section></div></footer></body></html>