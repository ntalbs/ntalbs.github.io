<!DOCTYPE html><html><head><meta name="google-site-verification" content="U8HPz3to00q8wRxuKaw82QsuVvOzGyPxcWhySSYAjOE"><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>프로젝트 오일러 66 | ntalbs&#39; stuff</title><meta name="description" content=""><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="ntalbs' stuff"></head><body class="home-template"><nav class="navbar" role="navigation"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#nav-items">+</button> <a class="navbar-brand" href="/">@ntalbs' stuff</a></div><div class="navbar-items collapsed" id="nav-items"><ul><li><a href="/archives">Archives</a></li><li><a href="/tags">Tags</a></li><li><a href="/about">About</a></li></ul></div></div></nav><div id="progress"><div id="bar"></div><div class="container"><div id="scroll-title">프로젝트 오일러 66</div></div></div><header class="site-head"><div class="container"><p class="blog-description">내 이 세상 도처에서 쉴 곳을 찾아보았으나, 마침내 찾아낸, 컴퓨터가 있는 구석방보다 나은 곳은 없더라.</p></div></header><main class="container" role="main"><article class="post"><header><p class="post-meta"><time datetime="2016-05-18T23:00:00.000Z" itemprop="datePublished">2016-05-19</time> on <a href="/tags/Clojure/" style="margin:0 5px">Clojure</a><a href="/tags/Project-Euler/" style="margin:0 5px">Project-Euler</a></p><h1 class="post-title">프로젝트 오일러 66</h1></header><section class="post-content"><blockquote><p>$x^2 – Dy^2 = 1$ 형태의 디오판토스 방정식 풀기<br>문제 자세히 보기: <a href="http://euler.synap.co.kr/prob_detail.php?id=66" target="_blank" rel="external">[국어]</a> <a href="https://projecteuler.net/problem=66" target="_blank" rel="external">[영어]</a></p></blockquote><p>$\sqrt D$의 $i$번째 근사분수(convergents)를 $\frac{h_i}{k_i}$라 하면, 펠 방정식의 해 중 $x$를 최소화하는 해 $(x_1, y_1)$은 $h_i^2 - Dk_i^2 = 1$를 만족시키는 $(h_i, k_i)$가 된다. $h_i, k_i$는 다음과 같이 구할 수 있다.</p><span>$$\begin{aligned} h_i &amp;= a_ih_{i-1} + h_{i-2} \\ k_i &amp;= a_ik_{i-1} + k_{i-2} \end{aligned}$$</span><a id="more"></a><p>첫 번째 근사분수는 $a_0$이므로 $h_0, k_0$는 각각 다음과 같이 초기화할 수 있다.</p><span>$$\begin{aligned} h_0 = a_0,\, k_0 = 1 \end{aligned}$$</span><p>두 번째 근사분수는 $a_0 + \frac{1}{a_1} = \frac{a_0a_1+1}{a_1}$이므로, $h_i, k_i$를 구하는 식에 $h_0, k_0$을 대입해 계산하면 $h_{-1}, k_{-1}$의 값은 다음과 같아야 한다.</p><span>$$\begin{aligned} h_{-1} = 1,, _{-1} = 0 \end{aligned}$$</span><p>이를 바탕으로, $h_i, k_i$를 계산해 $h_i^2 - Dk_i^2 = 1$이 되는 경우를 구하면 $(h_i, k_i)$가 펠 방정식의 해가 된다.</p><p><a href="/2016/project-euler-064">문제 64</a>에서 $\sqrt D$의 연분수꼴을 구하는 함수를 이미 구현했으므로 그대로 가져다 쓸 수 있다. 펠 방정식의 기본 해를 구하는 함수는 다음과 같이 작성할 수 있다. 루프를 돌면서 처음 찾은 해가 $x$를 최소화하는 해가 된다.</p><figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">ns</span></span> p066</span><br><span class="line">  (<span class="symbol">:require</span> [util <span class="symbol">:refer</span> [perfect-square?]]</span><br><span class="line">            [p064 <span class="symbol">:refer</span> [expand-continued-fraction]]))</span><br><span class="line"></span><br><span class="line">(<span class="name"><span class="builtin-name">defn</span></span> find-fundamental-solution</span><br><span class="line">  <span class="string">"find the fundamental solution of pell's equation,  x^2 - dy^2 = 1"</span></span><br><span class="line">  [d]</span><br><span class="line">  (<span class="name"><span class="builtin-name">let</span></span> [cf (<span class="name">expand-continued-fraction</span> d)</span><br><span class="line">        as (<span class="name">lazy-cat</span> cf (<span class="name"><span class="builtin-name">cycle</span></span> (<span class="name"><span class="builtin-name">rest</span></span> cf)))]</span><br><span class="line">    (<span class="name"><span class="builtin-name">loop</span></span> [h2 <span class="number">0</span>, h1 <span class="number">1</span>,</span><br><span class="line">           k2 <span class="number">1</span>, k1 <span class="number">0</span>,</span><br><span class="line">           as as, n <span class="number">0</span>]</span><br><span class="line">      (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">and</span></span> (<span class="name"><span class="builtin-name">&gt;=</span></span> n <span class="number">1</span>) (<span class="name"><span class="builtin-name">=</span></span> <span class="number">1</span> (<span class="name">-'</span> (<span class="name">*'</span> h1 h1) (<span class="name">*'</span> d k1 k1))))</span><br><span class="line">        [h1 k1]</span><br><span class="line">        (<span class="name"><span class="builtin-name">recur</span></span> h1 (<span class="name">+'</span> (<span class="name">*'</span> (<span class="name"><span class="builtin-name">first</span></span> as) h1) h2)</span><br><span class="line">               k1 (<span class="name">+'</span> (<span class="name">*'</span> (<span class="name"><span class="builtin-name">first</span></span> as) k1) k2)</span><br><span class="line">               (<span class="name"><span class="builtin-name">rest</span></span> as) (<span class="name"><span class="builtin-name">inc</span></span> n))))))</span><br></pre></td></tr></table></figure><p>이제 $D$를 2부터 1000까지 변경하면서 펠 방정식에서 $x$를 최소화하는 기본해를 구한 다음, 이 중 $x$값이 가장 큰 경우의 $D$를 구하면 된다. $D$ 완전제곱수인 경우에는 $(1, 0)$을 제외한 다른 정수해가 존재하지 않으므로 이를 제외해야 한다.</p><figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">(<span class="name"><span class="builtin-name">defn</span></span> solve []</span><br><span class="line">  (<span class="name"><span class="builtin-name">-&gt;&gt;</span></span> (<span class="name"><span class="builtin-name">range</span></span> <span class="number">2</span> (<span class="name"><span class="builtin-name">inc</span></span> <span class="number">1000</span>))</span><br><span class="line">       (<span class="name"><span class="builtin-name">filter</span></span> (<span class="name"><span class="builtin-name">complement</span></span> perfect-square?))</span><br><span class="line">       (<span class="name"><span class="builtin-name">map</span></span> (<span class="name"><span class="builtin-name">fn</span></span> [d] [d (<span class="name"><span class="builtin-name">first</span></span> (<span class="name">find-fundamental-solution</span> d))]))</span><br><span class="line">       (<span class="name"><span class="builtin-name">apply</span></span> (<span class="name"><span class="builtin-name">partial</span></span> max-key second))))</span><br></pre></td></tr></table></figure><p>실행 결과는 다음과 같다.</p><pre class="console">
p066=> (time (solve))
"Elapsed time: 21.273114 msecs"
6?1
</pre><h2 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h2><ul><li><a href="https://github.com/ntalbs/euler/blob/master/src/p066.clj" target="_blank" rel="external">프로젝트 오일러 66 풀이 소스 코드</a></li><li><a href="/2016/project-euler-064">프로젝트 오일러 64</a></li><li><a href="http://en.wikipedia.org/wiki/Continued_fraction" target="_blank" rel="external">Continued fraction</a></li><li><a href="https://en.wikipedia.org/wiki/Pell%27s_equation#Fundamental_solution_via_continued_fractions" target="_blank" rel="external">Pell’s equation &gt; Fundamental solution via continued fractions</a></li></ul></section><footer class="post-footer"><nav id="article-nav"><a href="/2016/uk-drivers-license/" id="article-nav-newer" class="article-nav-link-wrap"><span class="article-nav-title">영국 운전면허 교환</span> </a><a href="/2016/project-euler-065/" id="article-nav-older" class="article-nav-link-wrap"><span class="article-nav-title">프로젝트 오일러 65</span></a></nav><section id="comment"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></footer></article></main><footer class="site-footer"><div class="inner"><section class="copyright">&copy; 2008-2015 <a href="/about">ntalbs</a></section><section class="poweredby">Powered by <a class="icon-ghost" href="http://hexo.io">Hexo</a></section></div></footer><script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script type="text/javascript" src="/js/jquery.fitvids.js"></script><script type="text/javascript" src="/js/index.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script>!function(e,a,t,n,c,s,o){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,s=a.createElement(t),o=a.getElementsByTagName(t)[0],s.async=1,s.src=n,o.parentNode.insertBefore(s,o)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-2098194-3","auto"),ga("require","displayfeatures"),ga("send","pageview")</script><script type="text/javascript">var disqus_shortname="ntalbs-stuff";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>