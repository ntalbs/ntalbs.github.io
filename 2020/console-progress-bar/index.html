<!doctype html><html><head><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3882204692252974" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-2098194-3"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-2098194-3")</script><meta charset=utf-8><meta name=google-site-verification content="U8HPz3to00q8wRxuKaw82QsuVvOzGyPxcWhySSYAjOE"><meta property="og:image" content="https://ntalbs.github.io/images/ntalbs.jpg"><meta name=viewport content="width=device-width,initial-scale=1"><title>콘솔 프로그레스 바 @ntalbs' stuff</title><link rel="shortcut icon" href=/images/favicon.ico><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/highlight.css></head><body><div id=progress><div id=bar></div><div class=container><div id=scroll-title>콘솔 프로그레스 바</div></div></div><nav class=navbar role=navigation><div class=container><div class=navbar-header><button type=button class="navbar-toggle unselectable" data-toggle=collapse data-target=#nav-items>+</button>
<a class="navbar-brand unselectable" href=/>@ntalbs' stuff</a></div><div class="navbar-items collapsed" id=nav-items><ul><li><a class=unselectable href=/archive/>Archive</a></li><li><a class=unselectable href=/tags/>Tags</a></li><li><a class=unselectable href=/about/>About</a></li><li><a id=mode-switch class=unselectable href=#></a></li></ul></div></div></nav><header class=page-head><div class=container><p class=blog-description>내 이 세상 도처에서 쉴 곳을 찾아보았으나, 마침내 찾아낸, 컴퓨터가 있는 구석방보다 나은 곳은 없더라.</p></div></header><main class=container role=main><article class=post><header><p class=post-meta><time datetime=2020-06-06 itemprop=datePublished>2020-06-06</time>
on
<a href=/tags/%ed%8c%81/>팁</a></p><h1 class=post-title>콘솔 프로그레스 바</h1></header><section class=post-content><p>콘솔에서 프로그레스 바를 그릴 때 요령은 행을 바꾸지 않고 같은 행에 텍스트를 계속 갱신하는 것이다. 프로그레스 바와 진행률을 제외하면 다른 텍스트는 바뀌지 않을 것이므로 <code>\r</code>로 커서를 행의 처음으로 옮긴 후 새로운 텍스트로 덮어쓰면 프로그레스바가 깜박거리지 않을 것이다.</p><p>두 개 이상의 프로그레스 바를 그리려면 어떻게 해야 할까? 커서를 위로 옮길 수도 있어야 하므로 <code>\r</code> 만으로는 안 되고, <a href=https://en.wikipedia.org/wiki/ANSI_escape_code>ANSI 이스케이프 코드</a>를 써야 한다. ANSI 이스케이프 코드를 사용하면 콘솔 화면에서 커서를 이동하거나 출력 글자의 색상을 바꿀 수 있다.</p><p><code>\r</code>을 이용해 콘솔에 프로그레스 바를 출력하는 간단한 프로그램을 작성했다. 프로그레스 바를 그리는 부분은 그냥 <code>\r</code>를 썼고, ANSI 이스케이프 코드를 이용해 커서를 숨기고 글자 색상을 바꾸었다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-rust data-lang=rust><span class=line><span class=cl><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=p>{</span><span class=n>thread</span><span class=p>,</span><span class=w> </span><span class=n>time</span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>use</span><span class=w> </span><span class=n>std</span>::<span class=n>io</span>::<span class=p>{</span><span class=n>Write</span><span class=p>,</span><span class=w> </span><span class=n>stdout</span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>fn</span> <span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>let</span><span class=w> </span><span class=n>complete_char</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&#34;=&#34;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=kd>let</span><span class=w> </span><span class=n>pause_time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>time</span>::<span class=n>Duration</span>::<span class=n>from_millis</span><span class=p>(</span><span class=mi>50</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;Start:&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=fm>print!</span><span class=p>(</span><span class=s>&#34;\u{001b}[?25l&#34;</span><span class=p>);</span><span class=w>      </span><span class=c1>// hide cursor
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=fm>print!</span><span class=p>(</span><span class=s>&#34;\u{001b}[34m&#34;</span><span class=p>);</span><span class=w>       </span><span class=c1>// change text color to yellow
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=k>for</span><span class=w> </span><span class=n>_i</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>1</span><span class=o>..=</span><span class=mi>100</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>let</span><span class=w> </span><span class=n>complete</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>complete_char</span><span class=p>.</span><span class=n>repeat</span><span class=p>(</span><span class=n>_i</span><span class=o>/</span><span class=mi>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=fm>print!</span><span class=p>(</span><span class=s>&#34;\rProgress: |{:-&lt;50}| {:3}%&#34;</span><span class=p>,</span><span class=w> </span><span class=n>complete</span><span class=p>,</span><span class=w> </span><span class=n>_i</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>stdout</span><span class=p>().</span><span class=n>flush</span><span class=p>().</span><span class=n>unwrap</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>thread</span>::<span class=n>sleep</span><span class=p>(</span><span class=n>pause_time</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=fm>print!</span><span class=p>(</span><span class=s>&#34;\u{001b}[0m&#34;</span><span class=p>);</span><span class=w>        </span><span class=c1>// reset color
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=fm>println!</span><span class=p>(</span><span class=s>&#34;\nFinished.&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=fm>print!</span><span class=p>(</span><span class=s>&#34;\u{001b}[?25h&#34;</span><span class=p>);</span><span class=w>      </span><span class=c1>// show cursor
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>여기서는 프로그레스 바를 그릴 때는 러스트의 포매팅 기능을 사용했지만, 다른 방법을 사용해도 된다. 프로그레스 바를 업데이트한 다음 버퍼를 <code>flush</code> 해야 화면이 바로바로 갱신된다.</p><p>프로그래밍 언어별로 콘솔에서 프로그레스 바를 표시하게 해 주는 라이브러리가 이미 개발되어 있다. 프로그레스 바 모양을 쉽게 바꿀 수 있고 사용하기 편리한 프로그래밍 인터페이스도 제공한다. 콘솔에 프로그레스 바를 그릴 일이 있다면 아마도 라이브러리를 사용하는 편이 나을 것이다.</p><h3 id=참고>참고</h3><ul><li><a href=https://en.wikipedia.org/wiki/ANSI_escape_code>ANSI escape code</a></li></ul></section><footer class=post-footer><div class="social button-box"><a href=https://twitter.com/share class=twitter-share-button data-show-count=false>Tweet</a>
<a class=twitter-follow-button href=https://twitter.com/ntalbs data-show-count=false>Follow @ntalbs</a>
<script async src=//platform.twitter.com/widgets.js></script></div><nav id=article-nav><a class="article-nav-link-wrap previous" href=/2020/java-date-time-basic/ id=article-nav-newer>Java 날짜/시간 API</a>
<a class="article-nav-link-wrap next" href=/2020/switching-broadband/ id=article-nav-older>인터넷 공급업체 교체기</a></nav></footer></article></main><section class=section><div class=container><aside><div id=disqus_thread></div></aside><script type=text/javascript>var disqus_shortname="ntalbs-stuff",permalink="https://ntalbs.github.io/2020/console-progress-bar/".replace(/\//g,"/"),disqus_config=function(){this.page.url=permalink,this.page.identifier=permalink};(function(){var e=document,t=e.createElement("script");t.src="https://"+disqus_shortname+".disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div></section><section class=section><div class="container has-text-centered"><p></p></div></section><script src=/js/index.js type=text/javascript></script>
<script src=/js/mode.js type=text/javascript></script><footer class=page-bottom><div class=inner><section class=copyright>© 2008-2022 <a href=/about>ntalbs</a></section><section class=poweredby>Powered by <a class=icon-ghost href=https://gohugo.io>Hugo</a></section></div></footer></body></html>