<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>데이터 생성 SQL @ntalbs&#39; stuff</title>
<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="stylesheet" href="/css/style.css">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">


  </head>
  <body>
    <div id="progress">
  <div id="bar"></div>
  <div class="container">
    <div id="scroll-title">데이터 생성 SQL</div>
  </div>
</div>

    <nav class="navbar" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#nav-items">+</button>
      <a class="navbar-brand" href="/">@ntalbs&#39; stuff</a>
    </div>
    <div class="navbar-items collapsed" id="nav-items">
      <ul>
        
        <li><a href="/archive">Archive</a></li>
        
        <li><a href="/tags">Tags</a></li>
        
        <li><a href="/about">About</a></li>
        
      </ul>
    </div>
  </div>
</nav>

<header class="page-head">
  <div class="container">
    <p class="blog-description">내 이 세상 도처에서 쉴 곳을 찾아보았으나, 마침내 찾아낸, 컴퓨터가 있는 구석방보다 나은 곳은 없더라.</p>
  </div>
</header>

    <main class="container" role="main">
      <article class="post">
        <header>
          <p class="post-meta">
            <time datetime="2009-04-14" itemprop="datePublished">2009-04-14</time>
            on
            
            <a href="/tags/">DB</a>
            
            <a href="/tags/">SQL</a>
            
            <a href="/tags/">Oracle</a>
            
            <a href="/tags/">PostgreSQL</a>
            
          </p>
          <h1 class="post-title">
            데이터 생성 SQL
          </h1>
        </header>
        <section class="post-content">
          <p>Oracle에서라면 다음 쿼리로 row를 생성할 수 있다.</p>

<pre><code class="language-sql">-- 1~100까지 숫자 생성 (100 rows)
select level from dual connect by level &lt;= 100;
</code></pre>

<p>이렇게 row 생성 쿼리를 이용하면 테스트 데이터를 원하는 만큼 생성하는 것도 쉽고, 간단한 문제를 풀 때도 유용하다. 예를 들어 얼마 전 kldp.org에 올라왔던 1~45의 숫자 중 랜덤하게 6개를 선택해 표시하는 문제도 다음과 같이 SQL로 풀 수 있다.
</p>

<pre><code class="language-sql">-- 1~45의 숫자중 6개의 숫자를 랜덤하게 선택해 출력
select *
from (select level from dual
      connect by level &lt;=45
      order by dbms_random.random)
where rownum &lt;= 6;
</code></pre>

<p>그러나 이게 Oracle에서만 유효한 SQL이다보니 다른 DBMS에서는 활용할 수 없다. 요즘은 회사에서 사용하는PostgreSQL에서는 이 문제를 어떻게 해결할 수 있을까 고민했는데, 예상외로 쉬운 방법이 있었다. Oracle에서는 <code>connect by</code>를 이용한 재귀적 SQL을 사용했지만 PostgreSQL에서는 <code>generate_series()</code> 함수를 사용하면 된다.</p>

<pre><code class="language-sql">-- 1~100까지 숫자 생성 (100 rows)
select * from generate_series(1, 100);

-- 생성된 숫자를 이용한 계산이 필요할 때
select n, n*10 from generate_series(1, 100) as t(n);
</code></pre>

<p>따라서 1~45의 숫자 중 랜덤하게 6개를 선택해 표시하는 문제를 PostgreSQL에서는 다음과 같이 풀 수 있다.</p>

<pre><code class="language-sql">-- 1~45의 숫자중 6개의 숫자를 랜덤하게 선택해 출력
select *
from (select * from generate_series(1, 45)
      order by random()) as t
limit 6;
</code></pre>

<p>이와 비슷하게 데이터를 생성해내는 방법이 MySQL에도 있을까 찾아봤지만, 마음에 드는 방법을 찾지는 못했다. MySQL에서는 그냥 데이터가 많은 다른 테이블을 카테시안 조인해 데이터를 만들어내는 방법뿐인지, 아니면 다른 멋진 방법이 있는데 내가 알지 못하는 것인지 모르겠다.</p>
        </section>
        <footer class="post-footer">
          
          <div class="social button-box">
            
            <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a>
            <a class="twitter-follow-button" href="https://twitter.com/ntalbs" data-show-count="false">Follow @ntalbs</a>
            <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
            
          </div>
          
          <nav id="article-nav">
            
            <a class="article-nav-link-wrap previous" href="http://ntalbs.github.io/2009/wen-wan/" id="article-nav-newer"> &#39;웬&#39;과 &#39;왠&#39;</a>
            
            
            <a class="article-nav-link-wrap next" href="http://ntalbs.github.io/2009/credit-card/" id="article-nav-older"> 신용카드, 정말 재테크의 적인가?</a>
            
          </nav>
        </footer>
      </article>
    </main>
    
<section class="section">
  <div class="container">
    <aside><div id="disqus_thread"></div></aside>
    <script type="text/javascript">
     var disqus_shortname = 'ntalbs-stuff';
     (function() {
       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
       dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</section>


    <section class="section">
  <div class="container has-text-centered">
    <p></p>
  </div>
</section>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/clojure.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/java.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/sql.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/lisp.min.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2098194-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src=http://ntalbs.github.io/js/index.js type="text/javascript"></script>

    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
   tex2jax: {
     inlineMath: [['$','$']],
     displayMath: [['$$','$$']],
     processEscapes: true,
     processEnvironments: true,
     skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
     TeX: { equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "AMSsymbols.js"] }
   }
 });
</script>

  </body>
</html>
