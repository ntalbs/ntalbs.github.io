<!DOCTYPE html>
<html>
  <head>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-2098194-3"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-2098194-3');
</script>
<meta charset="UTF-8">

<meta name="google-site-verification" content="U8HPz3to00q8wRxuKaw82QsuVvOzGyPxcWhySSYAjOE" />

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>프로젝트 오일러 13 @ntalbs&#39; stuff</title>
<link rel="shortcut icon" href="/images/favicon.ico">
<link rel="stylesheet" href="/css/style.css">

  </head>
  <body>
    <div id="progress">
  <div id="bar"></div>
  <div class="container">
    <div id="scroll-title">프로젝트 오일러 13</div>
  </div>
</div>

    <nav class="navbar" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#nav-items">+</button>
      <a class="navbar-brand" href="/">@ntalbs&#39; stuff</a>
    </div>
    <div class="navbar-items collapsed" id="nav-items">
      <ul>
        
        <li><a href="/archive/">Archive</a></li>
        
        <li><a href="/tags/">Tags</a></li>
        
        <li><a href="/about/">About</a></li>
        
      </ul>
    </div>
  </div>
</nav>

<header class="page-head">
  <div class="container">
    <p class="blog-description">내 이 세상 도처에서 쉴 곳을 찾아보았으나, 마침내 찾아낸, 컴퓨터가 있는 구석방보다 나은 곳은 없더라.</p>
  </div>
</header>

    <main class="container" role="main">
      <article class="post">
        <header>
          <p class="post-meta">
            <time datetime="2015-03-18" itemprop="datePublished">2015-03-18</time>
            on
            
            <a href="/tags/project-euler/">Project-Euler</a>
            
            <a href="/tags/clojure/">Clojure</a>
            
          </p>
          <h1 class="post-title">
            프로젝트 오일러 13
          </h1>
        </header>
        <section class="post-content">
          <blockquote>
<p>50자리 숫자 100개를 더한 값의 첫 10자리 구하기</p>

<p>문제 자세히 보기: <a href="http://euler.synap.co.kr/prob_detail.php?id=13">[국어]</a> <a href="https://projecteuler.net/problem=13">[영어]</a></p>
</blockquote>

<p><code>Long.MAX_VALUE</code>는 9223372036854775807로 20자리 수를 표현할 수 있다. 문제에서 나오는 숫자는 50자리므로 <code>Long</code>의 표현 범위를 벗어난다. 이런 수를 100개 더하려면&hellip;</p>

<h2 id="방법-1">방법 1</h2>

<p>대부분의 현대적 언어에서는 이런 큰 수를 다루기 위한 별도 타입을 제공하며, 이를 활용하면 문제를 쉽게 풀 수 있다. Java에서는 <code>java.math.BigInteger</code>를 쓰면 자릿수에 관계없이 큰 수를 표현할 수 있다. Clojure에서는 <code>clojure.lang.BigInt</code>로 큰 수를 표현할 수 있다. 따라서 <code>BigInt</code>를 이용하면 별다른 노력을 들이지 않고 간단히 문제를 풀 수 있다. Clojure에서는 별도로 조치를 취하지 않아도 long 범위를 넘는 수는 <code>BigInt</code>로 변환된다.</p>

<pre class="console">
user=> 37107287533902102798797998220837590246510135740250
37107287533902102798797998220837590246510135740250<span style="color:yellow;font-weight:bold">N</span>
user=> (class 37107287533902102798797998220837590246510135740250)
clojure.lang.BigInt
</pre>

<p><code>BigInt</code>라도 Java에서처럼 별도의 메서드를 사용할 필요는 없다. Clojure에서는 <code>+</code>도 함수이며 <code>BigInt</code>에 대해서도 <code>+</code>를 그대로 사용할 수 있다. 따라서 다음과 같이 간단히 문제를 풀 수 있다.</p>

<pre><code class="language-clojure">(def nums [37107287533902102798797998220837590246510135740250
           46376937677490009712648124896970078050417018260538
           74324986199524741059474233309513058123726617309629
           ...
           53503534226472524250874054075591789781264330331690])

(defn solve1 []
  (-&gt; (apply + nums)
      str
      (subs 0 10)))
</code></pre>

<p>다음과 같이 빠르게 답을 구한다.</p>

<pre class="console">
p013=> (time (solve1))
"Elapsed time: 0.356553 msecs"
"5537376???"
</pre>

<h2 id="방법-2">방법 2</h2>

<p><code>BigInt</code>를 사용하면 문제 풀이가 너무 쉽기 때문에 문제 본래의 의도를 회피한 것이다. 여기서는 <code>BigInt</code>를 사용하지 않고 큰 수를 숫자 시퀀스(sequence of digits)로 표현해 문제를 풀어 보자.</p>

<p>먼저 다음과 같이 숫자를 입력받아 시퀀스로 바꾸는 함수를 작성한다.</p>

<pre><code class="language-clojure">(defn digits
  &quot;Retruns the list of digits of n.&quot;
  [n]
  (loop [n n acc '()]
    (if (= n 0)
      acc
      (recur (quot n 10) (conj acc (int (rem n 10)))))))
</code></pre>

<p>이미 <code>nums</code>에 <code>BigInt</code>로 숫자가 들어있는 것을 숫자 시퀀스로 바꾸려는 것인데, 이게 반칙이라 생각되면 문제에서 주어진 숫자 목록을 문자열로 만든 다음 이를 숫자 시퀀스로 바꿀 수 있다. 이렇게 하는 방법은 <a href="/2015/project-euler-008/">문제 8</a>에서 이미 살펴봤으므로 여기서는 생략한다.</p>

<p>이제 숫자 시퀀스 두 개를 더하는 방법을 생각해야 한다. 예를 들어, <code>(9 8 7 6)</code>과 <code>(8 7 6)</code>을 더하면 <code>(1 0 7 5 2)</code>이 나오도록 해야 한다. 종이에 숫자를 써서 더할 때와 동일한 방법을 적용해, 각 자리별로 숫자를 더하면서 더한 수가 10을 넘을 때 윗 자리에 1을 더하는 작업을 모든 자리에 대해 수행해야 한다.</p>

<ol>
<li>일단 두 시퀀스의 길이를 맞춘다. 더할 때 자릿수가 맞아야 하므로 짧은 쪽 앞에 0을 덧붙여 자릿수를 맞춰야 한다. <code>(9 8 7 6)</code>과 <code>(8 7 6)</code>을 더하려면 먼저 <code>(8 7 6)</code>을 <code>(0 8 7 6)</code>으로 만들어야 한다.</li>
<li>길이를 맞춘 두 시퀀스를 더한다. 간단히 <code>(map + seq1 seq2)</code>로 구할 수 있다. <code>(9 8 7 6)</code>과 <code>(0 8 7 6)</code>에 대해서는 <code>(9 16 14 12)</code>가 될 것이다.</li>
<li>뒤에서부터 10의 자리와 1의 자리로 숫자를 나눠 1의 자리수는 <code>acc</code>에 누적하고 10의 자리수는 앞자리와 더한다.</li>
<li>모든 자리에 대해 단계 3을 반복한다. 맨 앞자리 수가 10 이상이면 이 또한 10의 자리와 1의 자리로 분해해 단계 3을 반복해야 한다.</li>
</ol>

<p>여기서 단계 3이 특히 중요하다. 단계 3을 수행하는 함수는 다음과 같이 구현할 수 있다.</p>

<pre><code class="language-clojure">(defn- normalize-digits
  &quot;Returns a normalized sequence of digits.
  Normalized here means that every digit in the sequence is single digit.&quot;
  [ds]
  (loop [ds (reverse ds), acc '()]
    (let [cur (first ds)
          rst (rest ds)
          d10 (quot cur 10)
          d1 (rem cur 10)]
      (if (empty? rst)
        (if (= d10 0)
          (conj acc d1)
          (recur (list d10) (conj acc d1)))
        (recur (add-to-first rst d10) (conj acc d1))))))
</code></pre>

<p>코드가 조금 복잡한데, 루프를 돌면서 <code>ds</code>와 <code>acc</code>가 어떻게 바뀌는지 살펴보면 이해하는 데 도움이 된다. 각 자리를 뒤에서부터 (즉 1의자리부터) 처리하며 올라가는 것이 직관적이지만 리스트는 앞에서부터 처리하는 게 편하므로 <code>ds</code>를 <code>reverse</code>한 다음 진행하지만, 기본적으로 다음과 같이 처리된다고 할 수 있다.</p>

<pre><code>1: (12 34 56) | ()
2: (12 39)    | (6)
3: (15)       | (9 6)
4: (1)        | (5 9 6)
5: ()         | (1 5 9 6) =&gt; 끝
</code></pre>

<p>함수의 마지막 행에 있는 <code>add-to-first</code>는 리스트와 숫자를 받아 리스트의 맨 앞 요소에 숫자를 더하는 함수다.</p>

<pre><code class="language-clojure">(defn- add-to-first
  &quot;Returns a new list with its first element is (+ x (first ls)). &quot;
  [ls x]
  {:pre [(list? ls)]}
  (let [fv (first ls)]
    (if (nil? fv)
      nil
      (conj (rest ls) (+ fv x)))))
</code></pre>

<p><code>normalize-digits</code>가 있다면 두 시퀀스를 더하는 함수는 다음과 같이 쉽게 구할 수 있다.</p>

<pre><code class="language-clojure">(defn digits+
  &quot;Returns sum of two digits.&quot;
  [ds1 ds2]
  (let [cnt1 (count ds1)
        cnt2 (count ds2)
        ds1 (if (&lt; cnt1 cnt2) (lpad ds1 (- cnt2 cnt1)) ds1)
        ds2 (if (&lt; cnt1 cnt2) ds2 (lpad ds2 (- cnt1 cnt2)))
        added  (map + ds1 ds2)]
    (normalize-digits added)))
</code></pre>

<p>두 시퀀스를 더한 결과도 역시 시퀀스다. 함수 안에서 사용하는 <code>lpad</code>는 다음과 같이 구현하면 된다.</p>

<pre><code class="language-clojure">(defn- lpad [ds cnt]
  (concat (repeat cnt 0) ds))
</code></pre>

<p>여기까지 했다면, 답은 다음과 같이 구할 수 있다.</p>

<pre><code class="language-clojure">(defn solve2 []
  (-&gt;&gt; (map num-&gt;digits nums)
       (reduce add-digits)
       (take 10)
       (apply str)))
</code></pre>

<p>실행시켜보면 금방 답을 구한다.</p>

<pre class="console">
p013=> (time (solve2))
"Elapsed time: 8.531118 msecs"
"5537376???"
</pre>

<p><code>BigInt</code>를 썼을 때보다 많이 느려졌다. 어설프게 구현하는 것보다는 잘 되어 있는 라이브러리를 쓰는 게 훨씬 낫다.</p>

<h2 id="참고">참고</h2>

<ul>
<li><a href="https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/BigInt.java">Clojure의 BigInt 소스 코드</a></li>
<li><a href="https://github.com/ntalbs/euler/blob/master/src/p013.clj">프로젝트 오일러 13 풀이 소스 코드</a></li>
</ul>
        </section>
        <footer class="post-footer">
          
          <div class="social button-box">
            
            <a href="https://twitter.com/share" class="twitter-share-button" data-show-count="false">Tweet</a>
            <a class="twitter-follow-button" href="https://twitter.com/ntalbs" data-show-count="false">Follow @ntalbs</a>
            <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
            
          </div>
          
          <nav id="article-nav">
            
            <a class="article-nav-link-wrap previous" href="https://ntalbs.github.io/2015/hexo-upgrade/" id="article-nav-newer"> Hexo: 3.0 업그레이드</a>
            
            
            <a class="article-nav-link-wrap next" href="https://ntalbs.github.io/2015/project-euler-012/" id="article-nav-older"> 프로젝트 오일러 12</a>
            
          </nav>
        </footer>
      </article>
    </main>
    
<section class="section">
  <div class="container">
    <aside><div id="disqus_thread"></div></aside>
    <script type="text/javascript">
     var disqus_shortname = 'ntalbs-stuff';
     (function() {
       var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
       dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
       (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
  </div>
</section>


    <section class="section">
  <div class="container has-text-centered">
    <p></p>
  </div>
</section>
<script src=https://ntalbs.github.io/js/index.js type="text/javascript"></script>

    <link rel="stylesheet" href="/css/github.css">
<script type="text/javascript" src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
   tex2jax: {
     inlineMath: [['$','$']],
     displayMath: [['$$','$$']],
     processEscapes: true,
     processEnvironments: true,
     skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
     TeX: { equationNumbers: { autoNumber: "AMS" },
            extensions: ["AMSmath.js", "AMSsymbols.js"] }
   }
 });
</script>

    <footer class="page-bottom">
  <div class="inner">
    <section class="copyright">© 2008-2019 <a href="/about">ntalbs</a></section>
    <section class="poweredby">Powered by <a class="icon-ghost" href="https://gohugo.io">Hugo</a></section>
  </div>
</footer>

  </body>
</html>
