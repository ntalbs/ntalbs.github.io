<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-2098194-3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-2098194-3');</script><meta charset=utf-8><meta name=google-site-verification content="U8HPz3to00q8wRxuKaw82QsuVvOzGyPxcWhySSYAjOE"><meta name=viewport content="width=device-width,initial-scale=1"><title>프로젝트 오일러 18 @ntalbs' stuff</title><link rel="shortcut icon" href=/images/favicon.ico><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/xcode.css></head><body><div id=progress><div id=bar></div><div class=container><div id=scroll-title>프로젝트 오일러 18</div></div></div><nav class=navbar role=navigation><div class=container><div class=navbar-header><button type=button class="navbar-toggle unselectable" data-toggle=collapse data-target=#nav-items>+</button>
<a class="navbar-brand unselectable" href=/>@ntalbs' stuff</a></div><div class="navbar-items collapsed" id=nav-items><ul><li><a class=unselectable href=/archive/>Archive</a></li><li><a class=unselectable href=/tags/>Tags</a></li><li><a class=unselectable href=/about/>About</a></li><li><a id=mode-switch class=unselectable href=#></a></li></ul></div></div></nav><header class=page-head><div class=container><p class=blog-description>내 이 세상 도처에서 쉴 곳을 찾아보았으나, 마침내 찾아낸, 컴퓨터가 있는 구석방보다 나은 곳은 없더라.</p></div></header><main class=container role=main><article class=post><header><p class=post-meta><time datetime=2015-05-12 itemprop=datePublished>2015-05-12</time>
on
<a href=/tags/project-euler/>Project-Euler</a>
<a href=/tags/clojure/>Clojure</a></p><h1 class=post-title>프로젝트 오일러 18</h1></header><section class=post-content><blockquote><p>삼각형을 따라 내려가면서 합이 최대가 되는 경로 찾기</p><p>문제 자세히 보기: <a href="http://euler.synap.co.kr/prob_detail.php?id=18">[국어]</a> <a href="https://projecteuler.net/problem=18">[영어]</a></p></blockquote><p>문제를 언듯 보면 합이 최대가 되는 경로를 찾아야 할 것 같지만, 명시적으로 경로를 구하지 않더라도 경로의 합이 최대가 되는 값을 찾을 수 있다.</p><h2 id=알고리즘>알고리즘</h2><p>삼각형 꼭데기에 서 있다면 왼쪽 또는 오른쪽으로 내려갈 수 있다. 합이 최대가 되는 경로로 가려면 왼쪽으로 갔을 때의 합이 큰지 오른쪽으로 갔을 때의 합이 큰지 알아야 한다. 합이 최대가 되는 경로에 있는 숫자의 합을 그 삼각형의 <strong>최대합</strong>이라 한다면, 왼쪽 삼각형의 최대합이 큰지 오른쪽 삼각형의 최대합이 큰지 알아야 한다.</p><p><img src=/2015/05-12-project-euler-018/triangle1.png alt></p><p>오른쪽 삼각형과 왼쪽 삼각형의 꼭데기에서도 마찬가지다. 다시 말해 왼쪽으로 갈지 오른쪽으로 갈지를 결정하려면 그 아래 단계에 있는 삼각형의 최대합을 구할 수 있어야 한다. 아래 단계의 삼각형 역시 여러 층으로 되어 있다면 바로 최대합을 구할 수 없다. 계속해서 아래 단계로 내려가 거의 바닥까지 내려가면 아래 단계 삼각형이 이층 삼각형이 된다.</p><p><img src=/2015/05-12-project-euler-018/triangle2.png alt></p><p>이층 삼각형이라면 왼쪽으로 갔을 때의 합과 오른쪽으로 갔을 때의 합을 바로 구할 수 있다. 맨 아래 단계에 있는 각 삼각형에 대해 왼쪽 합과 오른쪽의 합을 구해 큰 값을 꼭데기에 쓴다면 다음 그림과 같이 될 것이다. 맨 아래층은 더 이상 필요하지 않으므로 지울 수 있다.</p><p><img src=/2015/05-12-project-euler-018/triangle3.png alt></p><p>다시 맨 아래 두 층에 대해서 같은 작업을 반복한다. 이런 식으로 밑에서부터 왼쪽 합과 오른쪽 합 중 큰 값을 계속해 위로 올리는 식으로 작업할 수 있다.</p><p><img src=/2015/05-12-project-euler-018/triangle4.png alt></p><p>계속 올라가다보면 결국 맨 위 두 층만 남을 것이다. 여기서 왼쪽과 오른쪽의 합 중 큰 값을 구하면 그 값이 합이 최대가 되는 경로의 합이 된다.</p><h2 id=코드>코드</h2><p>다음 그림과 같이 맨 아래층과 그 위층의 숫자에 대해 한 번은 왼쪽으로, 또 한 번은 오른쪽으로 더한 다음 큰 값을 구하는 작업을 반복해 문제를 풀 수 있다.</p><p><img src=/2015/05-12-project-euler-018/triangle5.png alt></p><p>각 층을 <code>vector</code>로 표현하면, 위 그림의 맨 아래층은 <code>[8 5 9 3]</code>으로, 그 윗층은 <code>[2 4 6]</code>으로 나타낼 수 있다.</p><pre class=console>
user=> (def ls [8 5 9 3])
#'user/ls
user=> (def us [2 4 6])
#'user/us
</pre><p>왼쪽으로 갔을 때의 합과 오른쪽으로 갔을 때의 합은 다음과 같이 간단히 구할 수 있다.</p><pre class=console>
user=> (map + ls us)
(10 9 15)
user=> (map + (rest ls) us)
(7 13 9)
</pre><p>그리고 두 합 중 큰 값은 다음과 같이 구할 수 있다.</p><pre class=console>
user=> (map max *1 *2)
(10 13 15)
</pre><p>이걸 다음과 같이 함수로 만들 수 있다.</p><div class=highlight><pre class=chroma><code class=language-clojure data-lang=clojure><span class=p>(</span><span class=k>fn </span><span class=p>[</span><span class=nv>ls</span> <span class=nv>us</span><span class=p>]</span> <span class=p>(</span><span class=nb>map </span><span class=nb>max </span><span class=p>(</span><span class=nb>map </span><span class=nb>+ </span><span class=nv>ls</span> <span class=nv>us</span><span class=p>)</span> <span class=p>(</span><span class=nb>map </span><span class=nb>+ </span><span class=p>(</span><span class=nb>rest </span><span class=nv>ls</span><span class=p>)</span> <span class=nv>us</span><span class=p>)</span><span class=p>)</span><span class=p>)</span>
</code></pre></div><p>위 함수를 맨 아래 층과 그 위층에 적용하고, 그 결과와 바로 위층에 적용하며 위로 올라가야 한다. 이런 작업에는 <code>reduce</code>를 사용하는 것이 알맞다. 따라서 다음과 같이 <code>find-max</code> 함수를 정의할 수 있다.</p><div class=highlight><pre class=chroma><code class=language-clojure data-lang=clojure><span class=p>(</span><span class=kd>defn </span><span class=nv>find-max</span> <span class=p>[</span><span class=nv>t</span><span class=p>]</span>
  <span class=p>(</span><span class=nb>reduce </span><span class=p>(</span><span class=k>fn </span><span class=p>[</span><span class=nv>ls</span> <span class=nv>us</span><span class=p>]</span> <span class=p>(</span><span class=nb>map </span><span class=nb>max </span><span class=p>(</span><span class=nb>map </span><span class=nb>+ </span><span class=nv>ls</span> <span class=nv>us</span><span class=p>)</span> <span class=p>(</span><span class=nb>map </span><span class=nb>+ </span><span class=p>(</span><span class=nb>rest </span><span class=nv>ls</span><span class=p>)</span> <span class=nv>us</span><span class=p>)</span><span class=p>)</span><span class=p>)</span> <span class=nv>t</span><span class=p>)</span><span class=p>)</span>
</code></pre></div><p>이제 문제를 다 푼 것과 마찬가지다. 삼각형은 다음과 같이 <code>vector</code>의 <code>vector</code>로 정의할 수 있다. 삼각형의 밑에서부터 올라가며 작업해야 한다. <code>fold-right</code>가 있다면 좋겠지만 Clojure 기본 함수에는 <code>fold-right</code>가 없으므로 <code>reverse</code>한 후 <code>reduce</code> 하면 같은 효과를 얻을 수 있다. 여기서는 계산 편의를 위해 미리 <code>reverse</code> 해 두었다.</p><div class=highlight><pre class=chroma><code class=language-clojure data-lang=clojure><span class=p>(</span><span class=k>def </span><span class=nv>triangle</span>
  <span class=p>(</span><span class=nf>reverse</span>
   <span class=p>[</span><span class=p>[</span><span class=mi>75</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>95</span> <span class=mi>64</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>17</span> <span class=mi>47</span> <span class=mi>82</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>18</span> <span class=mi>35</span> <span class=mi>87</span> <span class=mi>10</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>20</span>  <span class=mi>4</span> <span class=mi>82</span> <span class=mi>47</span> <span class=mi>65</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>19</span>  <span class=mi>1</span> <span class=mi>23</span> <span class=mi>75</span>  <span class=mi>3</span> <span class=mi>34</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>88</span>  <span class=mi>2</span> <span class=mi>77</span> <span class=mi>73</span>  <span class=mi>7</span> <span class=mi>63</span> <span class=mi>67</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>99</span> <span class=mi>65</span>  <span class=mi>4</span> <span class=mi>28</span>  <span class=mi>6</span> <span class=mi>16</span> <span class=mi>70</span> <span class=mi>92</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>41</span> <span class=mi>41</span> <span class=mi>26</span> <span class=mi>56</span> <span class=mi>83</span> <span class=mi>40</span> <span class=mi>80</span> <span class=mi>70</span> <span class=mi>33</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>41</span> <span class=mi>48</span> <span class=mi>72</span> <span class=mi>33</span> <span class=mi>47</span> <span class=mi>32</span> <span class=mi>37</span> <span class=mi>16</span> <span class=mi>94</span> <span class=mi>29</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>53</span> <span class=mi>71</span> <span class=mi>44</span> <span class=mi>65</span> <span class=mi>25</span> <span class=mi>43</span> <span class=mi>91</span> <span class=mi>52</span> <span class=mi>97</span> <span class=mi>51</span> <span class=mi>14</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>70</span> <span class=mi>11</span> <span class=mi>33</span> <span class=mi>28</span> <span class=mi>77</span> <span class=mi>73</span> <span class=mi>17</span> <span class=mi>78</span> <span class=mi>39</span> <span class=mi>68</span> <span class=mi>17</span> <span class=mi>57</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>91</span> <span class=mi>71</span> <span class=mi>52</span> <span class=mi>38</span> <span class=mi>17</span> <span class=mi>14</span> <span class=mi>91</span> <span class=mi>43</span> <span class=mi>58</span> <span class=mi>50</span> <span class=mi>27</span> <span class=mi>29</span> <span class=mi>48</span><span class=p>]</span>
    <span class=p>[</span><span class=mi>63</span> <span class=mi>66</span>  <span class=mi>4</span> <span class=mi>68</span> <span class=mi>89</span> <span class=mi>53</span> <span class=mi>67</span> <span class=mi>30</span> <span class=mi>73</span> <span class=mi>16</span> <span class=mi>69</span> <span class=mi>87</span> <span class=mi>40</span> <span class=mi>31</span><span class=p>]</span>
    <span class=p>[</span> <span class=mi>4</span> <span class=mi>62</span> <span class=mi>98</span> <span class=mi>27</span> <span class=mi>23</span>  <span class=mi>9</span> <span class=mi>70</span> <span class=mi>98</span> <span class=mi>73</span> <span class=mi>93</span> <span class=mi>38</span> <span class=mi>53</span> <span class=mi>60</span>  <span class=mi>4</span> <span class=mi>23</span><span class=p>]</span><span class=p>]</span><span class=p>)</span><span class=p>)</span>
</code></pre></div><p><code>find-max</code> 함수에 <code>triangle</code>을 인자로 주어 호출하면 답을 구할 수 있다.</p><div class=highlight><pre class=chroma><code class=language-clojure data-lang=clojure><span class=p>(</span><span class=kd>defn </span><span class=nv>solve</span> <span class=p>[</span><span class=p>]</span>
  <span class=p>(</span><span class=nf>find-max</span> <span class=nv>triangle</span><span class=p>)</span><span class=p>)</span>
</code></pre></div><p>실행 결과는 다음과 같다.</p><pre class=console>
p018=> (time (solve))
"Elapsed time: 0.382559 msecs"
(1074)
</pre><h2 id=참고>참고</h2><ul><li><a href=https://github.com/ntalbs/euler/blob/master/src/p018.clj>프로젝트 오일러 18 풀이 소스 코드</a></li><li><a href=/2016/project-euler-067/>프로젝트 오일러 67</a> 같은 문제다. 여기서는 삼각형이 15층에 불과했지만, 이 문제에서는 100층짜리 삼각형을 다뤄야 한다.</li></ul></section><footer class=post-footer><div class="social button-box"><a href=https://twitter.com/share class=twitter-share-button data-show-count=false>Tweet</a>
<a class=twitter-follow-button href=https://twitter.com/ntalbs data-show-count=false>Follow @ntalbs</a>
<script async src=//platform.twitter.com/widgets.js></script></div><nav id=article-nav><a class="article-nav-link-wrap previous" href=https://ntalbs.github.io/2015/project-euler-019/ id=article-nav-newer>프로젝트 오일러 19</a>
<a class="article-nav-link-wrap next" href=https://ntalbs.github.io/2015/excessive-logging/ id=article-nav-older>과도한 로깅</a></nav></footer></article></main><section class=section><div class=container><aside><div id=disqus_thread></div></aside><script type=text/javascript>var disqus_shortname='ntalbs-stuff';(function(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div></section><section class=section><div class="container has-text-centered"><p></p></div></section><script src=https://ntalbs.github.io/js/index.js type=text/javascript></script><script src=https://ntalbs.github.io/js/mode.js type=text/javascript></script><footer class=page-bottom><div class=inner><section class=copyright>© 2008-2020 <a href=/about>ntalbs</a></section><section class=poweredby>Powered by <a class=icon-ghost href=https://gohugo.io>Hugo</a></section></div></footer></body></html>