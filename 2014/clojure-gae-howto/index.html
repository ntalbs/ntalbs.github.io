<!doctype html><html><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-2098194-3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-2098194-3');</script><meta charset=utf-8><meta name=google-site-verification content="U8HPz3to00q8wRxuKaw82QsuVvOzGyPxcWhySSYAjOE"><meta name=viewport content="width=device-width,initial-scale=1"><title>구글 앱 엔진에 Clojure 앱 올리기 @ntalbs' stuff</title><link rel="shortcut icon" href=/images/favicon.ico><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/xcode.css></head><body><div id=progress><div id=bar></div><div class=container><div id=scroll-title>구글 앱 엔진에 Clojure 앱 올리기</div></div></div><nav class=navbar role=navigation><div class=container><div class=navbar-header><button type=button class="navbar-toggle unselectable" data-toggle=collapse data-target=#nav-items>+</button>
<a class="navbar-brand unselectable" href=/>@ntalbs' stuff</a></div><div class="navbar-items collapsed" id=nav-items><ul><li><a class=unselectable href=/archive/>Archive</a></li><li><a class=unselectable href=/tags/>Tags</a></li><li><a class=unselectable href=/about/>About</a></li></ul></div></div></nav><header class=page-head><div class=container><p class=blog-description>내 이 세상 도처에서 쉴 곳을 찾아보았으나, 마침내 찾아낸, 컴퓨터가 있는 구석방보다 나은 곳은 없더라.</p></div></header><main class=container role=main><article class=post><header><p class=post-meta><time datetime=2014-05-14 itemprop=datePublished>2014-05-14</time>
on
<a href=/tags/clojure/>Clojure</a></p><h1 class=post-title>구글 앱 엔진에 Clojure 앱 올리기</h1></header><section class=post-content><p><a href=https://cloud.google.com/products/app-engine/>구글 앱 엔진(Google App Engine)</a>은 Clojure를 위한 SDK를 따로 제공하지는 않지만 Clojure는 JVM에서 실행되므로 Java가 실행되는 환경이라면 Clojure도 실행할 수 있다.</p><h2 id=준비>준비</h2><p>먼저 Leiningen과 App Engine SDK (for Java)를 설치한다.</p><ul><li><a href=https://github.com/technomancy/leiningen>Leiningen</a> 2.x 설치</li><li><a href=https://developers.google.com/appengine/downloads>App Engine SDK for Java</a> 설치</li></ul><p>MacOS X에서 <a href=http://brew.sh/>Homebrew</a>를 사용한다면 다음과 같이 간단히 설치할 수 있다.</p><pre class=console>
$ brew install leiningen
...
$ brew install app-engine-java-sdk
</pre><h2 id=clojure-앱-만들기>Clojure 앱 만들기</h2><p>다음과 같이 <a href=https://github.com/yogthos/compojure-template>compojure-template</a>을 이용해 프로젝트를 생성한다.</p><pre class=console>
$ lein new compojure-app app-test
</pre><p>프로젝트를 생성한 다음 아래와 같이 실행하면 브라우저 창에 "Hello World!"를 표시한다.</p><pre class=console>
$ lein ring server
</pre><p>여기서는 이 상태 그대로 앱 엔진에 배포해 볼 것이다. Clojure로 웹 애플리케이션을 만드는 방법은 <a href=http://flowa.fi/blog/2014/04/25/clojure-gae-howto.html>원래 문서</a>나 <strong>참고</strong>에 나온 다른 도서를 보기 바란다.</p><h2 id=배포를-위한-패키징>배포를 위한 패키징</h2><p>다음 명령으로 war 파일을 생성한다.</p><pre class=console>
$ lein ring uberwar
</pre><p>war 파일은 프로젝트 루트 밑의 <code>target</code> 디렉터리 안에 생성된다. 다음과 같이 <code>unzip</code> 명령을 이용해 압축 해제한다. (파일 이름은 다를 수 있으며, 압축 해제할 디렉터리 이름이 꼭 stage일 필요는 없음)</p><pre class=console>
$ unzip -d stage target/test-app-0.1.0-SNAPSHOT-standalone.war
</pre><p><code>stage/WEB-INF</code> 디렉터리에 다음과 같은 내용으로 <code>appengine-web.xml</code> 파일을 만든다.</p><div class=highlight><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;appengine-web-app</span> <span class=na>xmlns=</span><span class=s>&#34;http://appengine.google.com/ns/1.0&#34;</span><span class=nt>&gt;</span>
  <span class=nt>&lt;application</span><span class=nt>&gt;</span>your-gae-application-id<span class=nt>&lt;/application&gt;</span>
  <span class=nt>&lt;version</span><span class=nt>&gt;</span>1<span class=nt>&lt;/version&gt;</span>
  <span class=nt>&lt;threadsafe</span><span class=nt>&gt;</span>false<span class=nt>&lt;/threadsafe&gt;</span>
<span class=nt>&lt;/appengine-web-app&gt;</span>
</code></pre></div><p><code>your-gae-application-id</code>는 <a href=https://appengine.google.com/>https://appengine.google.com/</a>에서 애플리케이션을 생성할 때 지정한 아이디를 넣어주면 된다.</p><h2 id=앱-엔진에-배포>앱 엔진에 배포</h2><p><code>&lt;app-engine-sdk>/bin</code>이 PATH에 잡혀 있어야 한다. MacOS X에서 Homebrew로 설치했다면 이미 PATH에 잡혀있을 것이다. 앱 엔진 서버에 배포하기 전에 로컬에서 테스트 해볼 수 있다</p><pre class=console>
$ dev_appserver.sh stage
</pre><p>브라우저를 열어 주소창에 <code>http://localhost:8080</code>을 입력해보면 실행 결과를 볼 수 있다.</p><p>앱 엔진 서버에 올린 준비가 되었다면 다음과 같이 배포한다.</p><pre class=console>
$ appcfg.sh update stage
</pre><p>서버로 배포하는 데는 시간이 좀 걸린다. 배포가 끝나면 브라우저로 <code>http://&lt;&lt;your-gae-application-id>>.appspot.com</code>에 접근해 확인할 수 있다.</p><h2 id=요약>요약</h2><p>과정을 요약하면 다음과 같다.</p><ol><li><code>lein new compojure-app &lt;project-name></code>으로 프로젝트 생성</li><li>웹 애플리케이션 작성</li><li><code>lein ring uberwar</code>로 war 파일 생성</li><li>생성된 war 파일을 압축 해재하고 <code>WEB-INF</code> 디렉터리에 <code>appengine-web.xml</code> 파일 생성</li><li><code>dev_appserver.sh</code>로 로컬에서 테스트</li><li><code>appcfg.sh</code>를 이용해 앱 엔진으로 업로드</li></ol><h2 id=참고>참고</h2><ul><li><a href=http://flowa.fi/blog/2014/04/25/clojure-gae-howto.html>Create and deploy a Clojure app to Google App Engine</a></li><li><a href=https://developers.google.com/appengine/docs/java/tools/uploadinganapp>Uploading and Managing a Java App</a></li><li><a href=https://pragprog.com/book/dswdcloj/web-development-with-clojure>Dmitri Sotnikov, Clojure Web Development</a>
얇지만 Clojure로 웹 애플리케이션을 만드는 방법이 자세히 나와있다</li><li><a href=http://shop.oreilly.com/product/0636920013754.do>Chas Emerick, Brian Carper, Christophe Grand, Clojure Programming</a>
p557~555, Hiccup 대신 <a href=https://github.com/cgrand/enlive>Enlive</a>를 사용한다</li></ul></section><footer class=post-footer><div class="social button-box"><a href=https://twitter.com/share class=twitter-share-button data-show-count=false>Tweet</a>
<a class=twitter-follow-button href=https://twitter.com/ntalbs data-show-count=false>Follow @ntalbs</a>
<script async src=//platform.twitter.com/widgets.js></script></div><nav id=article-nav><a class="article-nav-link-wrap previous" href=https://ntalbs.github.io/2014/ignoring-ie8/ id=article-nav-newer>IE8, 지원 해야 할까?</a>
<a class="article-nav-link-wrap next" href=https://ntalbs.github.io/2014/moderation/ id=article-nav-older>중용 23장</a></nav></footer></article></main><section class=section><div class=container><aside><div id=disqus_thread></div></aside><script type=text/javascript>var disqus_shortname='ntalbs-stuff';(function(){var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript rel=nofollow>comments powered by Disqus.</a></noscript></div></section><section class=section><div class="container has-text-centered"><p></p></div></section><script src=https://ntalbs.github.io/js/index.js type=text/javascript></script><footer class=page-bottom><div class=inner><section class=copyright>© 2008-2020 <a href=/about>ntalbs</a></section><section class=poweredby>Powered by <a class=icon-ghost href=https://gohugo.io>Hugo</a></section></div></footer></body></html>